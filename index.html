<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>try 50/50 :D</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .code-container {
            background-color: #2d2d2d;
            color: #2d2d2d; /* Same as background color */
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            white-space: pre;
            overflow-x: auto;
            position: relative;
        }
        .copy-button {
            margin-top: 10px;
            background-color: #2d2d2d;
            border: 1px solid #f8f8f2;
            color: #f8f8f2;
            cursor: pointer;
            padding: 5px 10px;
        }
        .download-button {
            margin-top: 10px;
            background-color: #2d2d2d;
            border: 1px solid #f8f8f2;
            color: #f8f8f2;
            cursor: pointer;
            padding: 5px 10px;
            display: none;
        }
        .file-input {
            margin-top: 10px;
        }
        select {
            margin-top: 20px;
        }
        .preview {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    Выбери форму или чет другое.. :<select id="codeSelector" onchange="switchCode()">
        <option value="version1">LoginForm</option>
        <option value="version2">RegisterForm</option>
        <option value="version3">Word?</option>
        <option value="version4">Word?</option>
    </select>
    <img id="codeImage" src="image1.jpg" alt="Code Image" style="display: block; margin-top: 20px;">
    <button class="copy-button" onclick="copyCode()">Copy All</button>
    <button id="downloadButton" class="download-button" onclick="downloadFile()">Download</button>
    <input type="file" id="fileInput" class="file-input" style="display:none;" onchange="previewFile()">
    <div id="filePreview" class="preview" style="display:none;"></div>
    <div id="codeDisplay" class="code-container"></div>

    <script>
        const codeVersions = {
            version1: `
using System;
using System.Data.SqlClient;
using System.Windows.Forms;

namespace gubar
{
    public partial class LoginForm : Form
    {
        public LoginForm()
        {
            InitializeComponent();
        }
        public void button2Click(object sender, EventArgs e)
        {
            SqlConnection conn = new SqlConnection(@"Data Source=TEXPY\SQLEXPRESS;Initial Catalog=demo;Integrated Security=True;");
            conn.Open();

            string query = "SELECT * FROM users WHERE login=@Login AND password=@Password";

            try
            {
                SqlCommand command = new SqlCommand(query, conn);
                command.Parameters.AddWithValue("@Login", text_Login.Text);
                command.Parameters.AddWithValue("@Password", text_Pass.Text);

                using (SqlDataReader reader = command.ExecuteReader())
                {
                    if (reader.HasRows)
                    {
                        reader.Read();
                        string role = reader["type"].ToString();

                        Form formx;
                        switch (role)
                        {
                            case "Менеджер":
                                formx = new ManagerForm();
                                break;
                            case "Мастер":
                                formx = new MasterForm();
                                break;
                            case "Оператор":
                                formx = new OperatorForm();
                                break;
                            case "Заказчик":
                                formx = new CustomerForm();
                                break;
                            default:
                                MessageBox.Show("Неизвестная должность.");
                                return;
                        }

                        FormManager.ShowForm(formx);
                    }
                    else
                    {
                        MessageBox.Show($"Неверный логин или пароль.");
                    }
                }
            }
            catch (Exception error)
            {
                Console.WriteLine("Ошибка:" + error.Message);
            }
            finally
            {
                conn.Close();
            }
        }

        private void toRegisterButton_Click(object sender, EventArgs e)
        {
            RegisterForm form = new RegisterForm();
            form.Show();
            this.Hide(); 
        }
    }
}
`,
            version2: `
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace gubar
{
    public partial class RegisterForm : Form
    {
        public RegisterForm()
        {
            InitializeComponent();
        }

        private void registerButton_Click(object sender, EventArgs e)
        {
            string fio = text_fio.Text;
            string phone = text_phone.Text;
            string login = text_login.Text;
            string password = text_password.Text;

            if (string.IsNullOrWhiteSpace(fio) || string.IsNullOrWhiteSpace(phone) ||
                string.IsNullOrWhiteSpace(login) || string.IsNullOrWhiteSpace(password))
            {
                MessageBox.Show("Все поля должны быть заполнены.");
                return;
            }

            string connectionString = @"Data Source=TEXPY\SQLEXPRESS;Initial Catalog=demo;Integrated Security=True;";
            string query = "INSERT INTO users (fio, phone, login, password, type) VALUES (@Fio, @Phone, @Login, @Password, 'Заказчик')";

            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                SqlCommand command = new SqlCommand(query, conn);
                command.Parameters.AddWithValue("@Fio", fio);
                command.Parameters.AddWithValue("@Phone", phone);
                command.Parameters.AddWithValue("@Login", login);
                command.Parameters.AddWithValue("@Password", password);

                try
                {
                    conn.Open();
                    int result = command.ExecuteNonQuery();

                    if (result > 0)
                    {
                        MessageBox.Show("Регистрация прошла успешно.");

                        this.Hide();

                        LoginForm loginForm = new LoginForm();
                        loginForm.ShowDialog();

                        this.Close();
                    }
                    else
                    {
                        MessageBox.Show("Ошибка регистрации. Попробуйте еще раз.");
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show("Ошибка при подключении к базе данных: " + ex.Message);
                }
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            this.Hide();
            LoginForm loginForm = new LoginForm();
            loginForm.ShowDialog();
            this.Close();
        }

        private void RegisterForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            Application.Exit();
        }

    }
}
`,
            version3: 'Word document content for version3',
            version4: 'Word document content for version4'
        };

        const codeImages = {
            version1: 'LoginForm.png',
            version2: 'RegisterForm.png'
        };

        function switchCode() {
            const selectedVersion = document.getElementById('codeSelector').value;
            document.getElementById('codeDisplay').innerText = codeVersions[selectedVersion];
            document.getElementById('codeImage').src = codeImages[selectedVersion];

            const downloadButton = document.getElementById('downloadButton');
            const fileInput = document.getElementById('fileInput');
            const filePreview = document.getElementById('filePreview');

            if (selectedVersion === 'version3' || selectedVersion === 'version4') {
                downloadButton.style.display = 'inline-block';
                fileInput.style.display = 'block';
                filePreview.style.display = 'block';
            } else {
                downloadButton.style.display = 'none';
                fileInput.style.display = 'none';
                filePreview.style.display = 'none';
            }
        }

        function copyCode() {
            const codeContainer = document.getElementById('codeDisplay');
            const range = document.createRange();
            range.selectNodeContents(codeContainer);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            try {
                document.execCommand('copy');
                alert('Содержимое скопировано!');
            } catch (err) {
                alert('Не удалось скопировать содержимое');
            }

            selection.removeAllRanges();
        }

        function downloadFile() {
            const selectedVersion = document.getElementById('codeSelector').value;
            const content = codeVersions[selectedVersion];
            const blob = new Blob([content], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `${selectedVersion}.txt`;
            link.click();
        }

        function previewFile() {
            const file = document.getElementById('fileInput').files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                document.getElementById('filePreview').innerText = e.target.result;
            };
            reader.readAsText(file);
        }

        switchCode();
    </script>
</body>
</html>
