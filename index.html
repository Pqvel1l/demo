<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸ‘€ðŸ”¥ðŸ’¥ðŸ‘€ðŸ”¥ðŸ’¥ðŸ‘€ðŸ”¥ðŸ’¥ðŸ‘€ðŸ”¥ðŸ’¥</title>
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        .code-container {
            background-color: #2d2d2d;
            color: #2d2d2d; /* Changed for better readability */
            padding: 10px;
            border-radius: 5px;
            margin-top: 20px;
            white-space: pre;
            overflow-x: auto;
            position: relative;
        }
        .copy-button, .download-button {
            margin-top: 10px;
            background-color: #2d2d2d;
            border: 1px solid #f8f8f2;
            color: #f8f8f2;
            cursor: pointer;
            padding: 5px 10px;
        }
        select {
            margin-top: 20px;
        }
        .preview {
            margin-top: 10px;
            padding: 10px;
            border: 1px solid #ccc;
        }
        .file-preview img {
            width: 100%;
            max-width: 300px;
            margin-top: 10px;
        }
        .file-preview a {
            display: block;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    Ð’Ñ‹Ð±ÐµÑ€Ð¸ Ñ„Ð¾Ñ€Ð¼Ñƒ Ð¸Ð»Ð¸ Ñ‡ÐµÑ‚ Ð´Ñ€ÑƒÐ³Ð¾Ðµ.. :<select id="codeSelector" onchange="switchCode()">
        <option value="version1">LoginForm</option>
        <option value="version2">RegisterForm</option>
        <option value="version3">UnitTests</option>
        <option value="version4">VSDX && WORD</option>
    </select>
    <button class="copy-button" onclick="copyCode()">Copy All</button>
    <button id="downloadButton" class="download-button" style="display: none;" onclick="downloadFile()">Download</button>
    <div id="filePreview" class="preview file-preview" style="display: none;"></div>
    <div id="codeDisplay" class="code-container"></div>

    <script>
        const codeVersions = {
            version1: `
using System;
using System.Data.SqlClient;
using System.Windows.Forms;

namespace gubar
{
    public partial class LoginForm : Form
    {
        public LoginForm()
        {
            InitializeComponent();
        }
        public void button2Click(object sender, EventArgs e)
        {
            SqlConnection conn = new SqlConnection(@"Data Source=TEXPY\\SQLEXPRESS;Initial Catalog=demo;Integrated Security=True;");
            conn.Open();

            string query = "SELECT * FROM users WHERE login=@Login AND password=@Password";

            try
            {
                SqlCommand command = new SqlCommand(query, conn);
                command.Parameters.AddWithValue("@Login", text_Login.Text);
                command.Parameters.AddWithValue("@Password", text_Pass.Text);

                using (SqlDataReader reader = command.ExecuteReader())
                {
                    if (reader.HasRows)
                    {
                        reader.Read();
                        string role = reader["type"].ToString();

                        Form formx;
                        switch (role)
                        {
                            case "ÐœÐµÐ½ÐµÐ´Ð¶ÐµÑ€":
                                formx = new ManagerForm();
                                break;
                            case "ÐœÐ°ÑÑ‚ÐµÑ€":
                                formx = new MasterForm();
                                break;
                            case "ÐžÐ¿ÐµÑ€Ð°Ñ‚Ð¾Ñ€":
                                formx = new OperatorForm();
                                break;
                            case "Ð—Ð°ÐºÐ°Ð·Ñ‡Ð¸Ðº":
                                formx = new CustomerForm();
                                break;
                            default:
                                MessageBox.Show("ÐÐµÐ¸Ð·Ð²ÐµÑÑ‚Ð½Ð°Ñ Ð´Ð¾Ð»Ð¶Ð½Ð¾ÑÑ‚ÑŒ.");
                                return;
                        }

                        FormManager.ShowForm(formx);
                    }
                    else
                    {
                        MessageBox.Show($"ÐÐµÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð»Ð¾Ð³Ð¸Ð½ Ð¸Ð»Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ.");
                    }
                }
            }
            catch (Exception error)
            {
                Console.WriteLine("ÐžÑˆÐ¸Ð±ÐºÐ°:" + error.Message);
            }
            finally
            {
                conn.Close();
            }
        }

        private void toRegisterButton_Click(object sender, EventArgs e)
        {
            RegisterForm form = new RegisterForm();
            form.Show();
            this.Hide(); 
        }
    }
}
`,
            version2: `
using System;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Data.SqlClient;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace gubar
{
    public partial class RegisterForm : Form
    {
        public RegisterForm()
        {
            InitializeComponent();
        }

        private void registerButton_Click(object sender, EventArgs e)
        {
            string fio = text_fio.Text;
            string phone = text_phone.Text;
            string login = text_login.Text;
            string password = text_password.Text;

            if (string.IsNullOrWhiteSpace(fio) || string.IsNullOrWhiteSpace(phone) ||
                string.IsNullOrWhiteSpace(login) || string.IsNullOrWhiteSpace(password))
            {
                MessageBox.Show("Ð’ÑÐµ Ð¿Ð¾Ð»Ñ Ð´Ð¾Ð»Ð¶Ð½Ñ‹ Ð±Ñ‹Ñ‚ÑŒ Ð·Ð°Ð¿Ð¾Ð»Ð½ÐµÐ½Ñ‹.");
                return;
            }

            string connectionString = @"Data Source=TEXPY\\SQLEXPRESS;Initial Catalog=demo;Integrated Security=True;";
            string query = "INSERT INTO users (fio, phone, login, password, type) VALUES (@Fio, @Phone, @Login, @Password, 'Ð—Ð°ÐºÐ°Ð·Ñ‡Ð¸Ðº')";

            using (SqlConnection conn = new SqlConnection(connectionString))
            {
                SqlCommand command = new SqlCommand(query, conn);
                command.Parameters.AddWithValue("@Fio", fio);
                command.Parameters.AddWithValue("@Phone", phone);
                command.Parameters.AddWithValue("@Login", login);
                command.Parameters.AddWithValue("@Password", password);

                try
                {
                    conn.Open();
                    int result = command.ExecuteNonQuery();

                    if (result > 0)
                    {
                        MessageBox.Show("Ð ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¿Ñ€Ð¾ÑˆÐ»Ð° ÑƒÑÐ¿ÐµÑˆÐ½Ð¾.");

                        this.Hide();

                        LoginForm loginForm = new LoginForm();
                        loginForm.ShowDialog();

                        this.Close();
                    }
                    else
                    {
                        MessageBox.Show("ÐžÑˆÐ¸Ð±ÐºÐ° Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸. ÐŸÐ¾Ð¿Ñ€Ð¾Ð±ÑƒÐ¹Ñ‚Ðµ ÐµÑ‰Ðµ Ñ€Ð°Ð·.");
                    }
                }
                catch (Exception ex)
                {
                    MessageBox.Show("ÐžÑˆÐ¸Ð±ÐºÐ° Ð¿Ñ€Ð¸ Ð¿Ð¾Ð´ÐºÐ»ÑŽÑ‡ÐµÐ½Ð¸Ð¸ Ðº Ð±Ð°Ð·Ðµ Ð´Ð°Ð½Ð½Ñ‹Ñ…: " + ex.Message);
                }
            }
        }

        private void button1_Click(object sender, EventArgs e)
        {
            this.Hide();
            LoginForm loginForm = new LoginForm();
            loginForm.ShowDialog();
            this.Close();
        }

        private void RegisterForm_FormClosing(object sender, FormClosingEventArgs e)
        {
            Application.Exit();
        }

    }
}
`,
            version3: '
                using gubar;
using Microsoft.VisualStudio.TestTools.UnitTesting;
// Ð¢Ñ‹ÐºÐ°ÐµÐ¼ Ð½Ð° Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° ÐŸÐšÐœ, Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ, Ñ‚Ñ‹ÐºÐ°ÐµÐ¼ "Ð¡Ð¾Ð·Ð´Ð°Ñ‚ÑŒ Ð¿Ñ€Ð¾ÐµÐºÑ‚", Ð·Ð°Ñ‚ÐµÐ¼ Ñ‚Ñ‹ÐºÐ°ÐµÐ¼ ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð¼Ð¾Ð´ÑƒÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð° (.NET Framework)
// ÐÐ°Ð·Ð²Ð°Ð½Ð¸Ðµ ÑÑ‚Ð°Ð²Ð¸Ð¼ Ð»ÑŽÐ±Ð¾Ðµ. Ð—Ð°Ñ‚ÐµÐ¼, ÐµÐ±Ð°ÑˆÐ¸Ð¼ Ð·Ð½Ð°Ñ‡Ð¸Ñ‚ÑÑ, Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸, Ð¿Ð¾ÑÐ»Ðµ ÑÐ¾Ð·Ð´Ð°Ð½Ð¸Ñ Ð¾Ñ‚Ð´ÐµÐ»ÑŒÐ½Ð¾Ð³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð° Ñƒ Ð½Ð°Ñ Ð² Ð¾Ð±Ð¾Ð·Ñ€ÐµÐ²Ð°Ñ‚ÐµÐ»Ðµ Ñ€ÐµÑˆÐµÐ½Ð¸Ð¹.
// Ð­Ñ‚Ð¾ Ð¼Ð¾Ð¶Ð½Ð¾ ÑÐ´ÐµÐ»Ð°Ñ‚ÑŒ, Ð½Ð°Ð¶Ð°Ð² ÐŸÐšÐœ Ð½Ð° UnitTestProject1 (ÑÑ‚Ð¾ Ð½Ð°Ð·Ð²Ð°Ð½Ð¸Ðµ Ð²Ð°ÑˆÐµÐ³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°, Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ Ð¾Ð½Ð¾ Ñ‚Ð°ÐºÐ¾Ðµ.) Ð¸ Ð½Ð°Ñ…Ð¾Ð´Ð¸Ð¼ Ñ‚Ð°Ð¼ "Ð—Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚Ð¸"
// Ð˜ ÑÑ‚Ð°Ð²Ð¸Ð¼ Ñ‚Ð°Ð¼ Ð³Ð°Ð»Ð¾Ñ‡ÐºÑƒ Ð´Ð»Ñ Ð½Ð°ÑˆÐµÐ³Ð¾ Ð¿Ñ€Ð¾ÐµÐºÑ‚Ð°. ÐŸÐµÑ€Ð²Ñ‹Ð¹ Ð¿ÑƒÐ½ÐºÑ‚ Ð¾ÐºÐ¾Ð½Ñ‡ÐµÐ½. 
// Ð’Ñ‚Ð¾Ñ€Ð¾Ð¹ Ð¿ÑƒÐ½ÐºÑ‚. ÐÐ°Ð¶Ð¸Ð¼Ð°ÐµÐ¼ Ð² Ð½Ð°ÑˆÐµÐ¼ ÑÑ‚Ð¾Ð¼ UnitTestProject1 Ð½Ð° "Ð¡ÑÑ‹Ð»ÐºÐ¸" Ð¸ Ð¶Ð¼Ñ‘Ð¼ "Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÐ¸". Ð¢Ð°Ð¼ Ð² Ð¾ÐºÐ½Ðµ, Ð½ÑƒÐ¶Ð½Ð¾ Ð½Ð°Ð¹Ñ‚Ð¸ "ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹" Ð¸ Ð´Ð¾Ð°Ð±Ð²Ð¸Ñ‚ÑŒ Ð½Ð°Ñˆ Ð¿Ñ€Ð¾ÐµÐºÑ‚ Ð² Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÑŒ!!!
// Ð¢Ð°Ðº Ð¶Ðµ, Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð´Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ ÑÑÑ‹Ð»ÐºÑƒ System.Windows.Forms Ñ‡Ñ‚Ð¾Ð±Ñ‹ Ð¼Ñ‹ Ð¼Ð¾Ð³Ð»Ð¸ Ñ‚ÐµÑÑ‚Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ Ð½Ð°ÑˆÐ¸ Ñ„Ð¾Ñ€Ð¼Ñ‹. Ð•ÑÐ»Ð¸ Ð²Ñ‹ Ð²ÑÑ‘ ÑÐ´ÐµÐ»Ð°Ð»Ð¸ Ð²ÐµÑ€Ð½Ð¾ -  Ð²Ñ‹ Ð¼Ð¾Ð»Ð¾Ð´Ñ†Ñ‹, ÐµÑÐ»Ð¸ Ð½ÐµÑ‚ - Ð°Ð½Ð»Ð°Ðº :)
namespace UnitTestProject1
{
    [TestClass]
    public class UnitTest1
    {
        [TestMethod]
        public void TestMethod1()//Ð²ÐµÑ€Ð½Ñ‹Ð¹ Ð»Ð¾Ð³Ð¸Ð½ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ
        {
            {
                var loginForm = new LoginForm();
                loginForm.text_Login.Text = "login1";// Ð¢ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð°
                loginForm.text_Pass.Text = "pass1";// Ð¢ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð°
                loginForm.button2Click(null, null);//"ÐÐ°Ð¶Ð°Ñ‚Ð¸Ðµ" Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ
                Assert.IsFalse(loginForm.Visible);

            }
        }
        [TestMethod]
        public void TestMethod2() // NEÐ²ÐµÑ€Ð½Ñ‹Ð¹ Ð»Ð¾Ð³Ð¸Ð½ Ð¸ Ð¿Ð°Ñ€Ð¾Ð»ÑŒ
        {
            var loginForm = new LoginForm();
            loginForm.text_Login.Text = "123"; // Ð¢ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð°
            loginForm.text_Pass.Text = "123"; // Ð¢ÐµÑÑ‚Ð¾Ð²Ð¾Ðµ Ð·Ð½Ð°Ñ‡ÐµÐ½Ð¸Ðµ Ð´Ð»Ñ Ð²Ñ…Ð¾Ð´Ð°
            loginForm.button2Click(null, null); // "ÐÐ°Ð¶Ð°Ñ‚Ð¸Ðµ" Ð½Ð° ÐºÐ½Ð¾Ð¿ÐºÑƒ
            Assert.IsFalse(loginForm.Visible);
        }
    }
}

                ',
            version4: [
                { name: 'functionSchema.vsdx', type: 'file', content: 'Ð¡Ñ…ÐµÐ¼Ð° Ñ„ÑƒÐ½ÐºÑ†Ð¸Ð¸' },
                { name: 'ProgrammSchema.vsdx', type: 'file', content: 'Ð¡Ñ…ÐµÐ¼Ð° Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ñ‹' },
                { name: 'ERDiag.vsdx', type: 'file', content: 'ER-Ð”Ð˜ÐÐ“Ð ÐÐœÐœÐ' },
                { name: 'ProgrammUpdateExamples.docx', type: 'file', content: 'Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ ÐŸÐž' },
                { name: 'AdminRukovod.docx', type: 'file', content: 'Ð£Ð»ÑƒÑ‡ÑˆÐµÐ½Ð¸Ðµ ÐŸÐž' },
                { name: 'Specification.docx', type: 'file', content: 'Ð¡Ð¿ÐµÑ†Ð¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ' },
                { name: 'FIGURES_VISIO.png', type: 'image', src: 'FIGURES_VISIO.png' },
                { name: 'FIGURES_VISIO2.png', type: 'image', src: 'FIGURES_VISIO2.png' },
                { name: 'GOST_VISIO.pdf', type: 'pdf', src: 'GOST_VISIO.pdf' },
                { name: 'PrimaryKEYS_VISIO.png', type: 'image', src: 'PrimaryKEYS_VISIO.png' }
                // Ð´Ð¾Ð±Ð°Ð²ÑŒÑ‚Ðµ Ð´Ñ€ÑƒÐ³Ð¸Ðµ Ñ„Ð°Ð¹Ð»Ñ‹
            ]
        };

        function switchCode() {
            const selectedVersion = document.getElementById('codeSelector').value;
            const codeDisplay = document.getElementById('codeDisplay');
            const downloadButton = document.getElementById('downloadButton');
            const filePreview = document.getElementById('filePreview');

            if (selectedVersion === 'version4') {
                filePreview.innerHTML = codeVersions[selectedVersion].map(item => {
                    if (item.type === 'image') {
                        return `<img src="${item.src}" alt="${item.name}" class="file-preview-img">`;
                    } else if (item.type === 'pdf') {
                        return `<a href="${item.src}" target="_blank">${item.name}</a>`;
                    } else if (item.type === 'file') {
                        return `<a href="#" onclick="downloadFile('${item.name}')">${item.name}</a>`;
                    } else {
                        return '';
                    }
                }).join('');
                codeDisplay.innerText = '';
                downloadButton.style.display = 'none';
                filePreview.style.display = 'block';
            } else {
                codeDisplay.innerText = codeVersions[selectedVersion];
                downloadButton.style.display = 'inline-block';
                filePreview.style.display = 'none';
            }
        }

        function copyCode() {
            const codeContainer = document.getElementById('codeDisplay');
            const range = document.createRange();
            range.selectNodeContents(codeContainer);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);

            try {
                document.execCommand('copy');
                alert('Ð¡Ð¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¾!');
            } catch (err) {
                alert('ÐÐµ ÑƒÐ´Ð°Ð»Ð¾ÑÑŒ ÑÐºÐ¾Ð¿Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ð¼Ð¾Ðµ');
            }

            selection.removeAllRanges();
        }

        function downloadFile(fileName) {
            const file = codeVersions.version4.find(f => f.name === fileName);
            const blob = new Blob([file.content], { type: 'application/octet-stream' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = fileName;
            link.click();
        }

        switchCode();
    </script>
</body>
</html>
